{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Observable, Subject, empty, of, merge } from \"rxjs\";\nimport { mergeMap, first, timeoutWith, delay, takeUntil, map, groupBy, filter, pairwise } from \"rxjs/operators\";\nexport default (function (_ref) {\n  var _ref$triggerPressEven = _ref.triggerPressEventBefore,\n      triggerPressEventBefore = _ref$triggerPressEven === void 0 ? 200 : _ref$triggerPressEven,\n      _ref$triggerLongPress = _ref.triggerLongPressEventAfter,\n      triggerLongPressEventAfter = _ref$triggerLongPress === void 0 ? 700 : _ref$triggerLongPress,\n      _ref$moveThreshold = _ref.moveThreshold,\n      moveThreshold = _ref$moveThreshold === void 0 ? 0 : _ref$moveThreshold;\n  return function (touches) {\n    var touchStart = new Subject().pipe(map(function (e) {\n      return {\n        id: e.identifier,\n        type: \"start\",\n        event: e\n      };\n    }));\n    var touchMove = new Subject().pipe(map(function (e) {\n      return {\n        id: e.identifier,\n        type: \"move\",\n        event: e\n      };\n    }));\n    var touchEnd = new Subject().pipe(map(function (e) {\n      return {\n        id: e.identifier,\n        type: \"end\",\n        event: e\n      };\n    }));\n    var touchPress = touchStart.pipe(mergeMap(function (e) {\n      return touchEnd.pipe(first(function (x) {\n        return x.id === e.id;\n      }), timeoutWith(triggerPressEventBefore, empty()));\n    }), map(function (e) {\n      return _objectSpread(_objectSpread({}, e), {}, {\n        type: \"press\"\n      });\n    }));\n    var touchMoveDelta = merge(touchStart, touchMove, touchEnd).pipe(groupBy(function (e) {\n      return e.id;\n    }), mergeMap(function (group) {\n      return group.pipe(pairwise(), map(function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 2),\n            e1 = _ref3[0],\n            e2 = _ref3[1];\n\n        if (e1.type !== \"end\" && e2.type === \"move\") {\n          return {\n            id: group.key,\n            type: \"move\",\n            event: e2.event,\n            delta: {\n              locationX: e2.event.locationX - e1.event.locationX,\n              locationY: e2.event.locationY - e1.event.locationY,\n              pageX: e2.event.pageX - e1.event.pageX,\n              pageY: e2.event.pageY - e1.event.pageY,\n              timestamp: e2.event.timestamp - e1.event.timestamp\n            }\n          };\n        }\n      }), filter(function (e) {\n        return e;\n      }), filter(function (e) {\n        return Math.pow(e.delta.pageX, 2) + Math.pow(e.delta.pageY, 2) > Math.pow(moveThreshold, 2);\n      }));\n    }));\n    var longTouch = touchStart.pipe(mergeMap(function (e) {\n      return of(e).pipe(delay(triggerLongPressEventAfter), takeUntil(merge(touchMoveDelta, touchEnd).pipe(first(function (x) {\n        return x.id === e.id;\n      }))));\n    }), map(function (e) {\n      return _objectSpread(_objectSpread({}, e), {}, {\n        type: \"long-press\"\n      });\n    }));\n    var subscriptions = [touchStart, touchEnd, touchPress, longTouch, touchMoveDelta].map(function (x) {\n      return x.subscribe(function (y) {\n        return touches.push(y);\n      });\n    });\n    return {\n      process: function process(type, event) {\n        switch (type) {\n          case \"start\":\n            touchStart.next(event);\n            break;\n\n          case \"move\":\n            touchMove.next(event);\n            break;\n\n          case \"end\":\n            touchEnd.next(event);\n            break;\n        }\n      },\n      end: function end() {\n        subscriptions.forEach(function (x) {\n          return x.unsubscribe();\n        });\n        touchStart.unsubscribe();\n        touchMove.unsubscribe();\n        touchEnd.unsubscribe();\n        touchPress.unsubscribe();\n        longTouch.unsubscribe();\n      }\n    };\n  };\n});","map":{"version":3,"sources":["/home/mming/Desktop/winter-2021-codefest-submissions-bug-busters/app/node_modules/react-native-game-engine/src/DefaultTouchProcessor.js"],"names":["Observable","Subject","empty","of","merge","mergeMap","first","timeoutWith","delay","takeUntil","map","groupBy","filter","pairwise","triggerPressEventBefore","triggerLongPressEventAfter","moveThreshold","touches","touchStart","pipe","e","id","identifier","type","event","touchMove","touchEnd","touchPress","x","touchMoveDelta","group","e1","e2","key","delta","locationX","locationY","pageX","pageY","timestamp","longTouch","subscriptions","subscribe","y","push","process","next","end","forEach","unsubscribe"],"mappings":"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","sourcesContent":["import { Observable, Subject, empty, of, merge } from \"rxjs\";\nimport {\n\tmergeMap,\n\tfirst,\n\ttimeoutWith,\n\tdelay,\n\ttakeUntil,\n\tmap,\n\tgroupBy,\n\tfilter,\n\tpairwise\n} from \"rxjs/operators\";\n\nexport default ({\n\ttriggerPressEventBefore = 200,\n\ttriggerLongPressEventAfter = 700,\n\tmoveThreshold = 0\n}) => {\n\treturn touches => {\n\t\tlet touchStart = new Subject().pipe(\n\t\t\tmap(e => ({ id: e.identifier, type: \"start\", event: e }))\n\t\t);\n\t\tlet touchMove = new Subject().pipe(\n\t\t\tmap(e => ({ id: e.identifier, type: \"move\", event: e }))\n\t\t);\n\t\tlet touchEnd = new Subject().pipe(\n\t\t\tmap(e => ({ id: e.identifier, type: \"end\", event: e }))\n\t\t);\n\n\t\tlet touchPress = touchStart.pipe(\n\t\t\tmergeMap(e =>\n\t\t\t\ttouchEnd.pipe(\n\t\t\t\t\tfirst(x => x.id === e.id),\n\t\t\t\t\ttimeoutWith(triggerPressEventBefore, empty())\n\t\t\t\t)\n\t\t\t),\n\t\t\tmap(e => ({ ...e, type: \"press\" }))\n\t\t);\n\n\t\tlet touchMoveDelta = merge(touchStart, touchMove, touchEnd).pipe(\n\t\t\tgroupBy(e => e.id),\n\t\t\tmergeMap(group =>\n\t\t\t\tgroup.pipe(\n\t\t\t\t\tpairwise(),\n\t\t\t\t\tmap(([e1, e2]) => {\n\t\t\t\t\t\tif (e1.type !== \"end\" && e2.type === \"move\") {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tid: group.key,\n\t\t\t\t\t\t\t\ttype: \"move\",\n\t\t\t\t\t\t\t\tevent: e2.event,\n\t\t\t\t\t\t\t\tdelta: {\n\t\t\t\t\t\t\t\t\tlocationX: e2.event.locationX - e1.event.locationX,\n\t\t\t\t\t\t\t\t\tlocationY: e2.event.locationY - e1.event.locationY,\n\t\t\t\t\t\t\t\t\tpageX: e2.event.pageX - e1.event.pageX,\n\t\t\t\t\t\t\t\t\tpageY: e2.event.pageY - e1.event.pageY,\n\t\t\t\t\t\t\t\t\ttimestamp: e2.event.timestamp - e1.event.timestamp\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tfilter(e => e),\n\t\t\t\t\tfilter(e => e.delta.pageX ** 2 + e.delta.pageY ** 2 > moveThreshold ** 2)\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\n\t\tlet longTouch = touchStart.pipe(\n\t\t\tmergeMap(e =>\n\t\t\t\tof(e).pipe(\n\t\t\t\t\tdelay(triggerLongPressEventAfter),\n\t\t\t\t\ttakeUntil(\n\t\t\t\t\t\tmerge(touchMoveDelta, touchEnd).pipe(\n\t\t\t\t\t\t\tfirst(x => x.id === e.id)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t),\n\t\t\tmap(e => ({ ...e, type: \"long-press\" }))\n\t\t);\n\n\t\tlet subscriptions = [\n\t\t\ttouchStart,\n\t\t\ttouchEnd,\n\t\t\ttouchPress,\n\t\t\tlongTouch,\n\t\t\ttouchMoveDelta\n\t\t].map(x => x.subscribe(y => touches.push(y)));\n\n\t\treturn {\n\t\t\tprocess(type, event) {\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase \"start\":\n\t\t\t\t\t\ttouchStart.next(event);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"move\":\n\t\t\t\t\t\ttouchMove.next(event);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"end\":\n\t\t\t\t\t\ttouchEnd.next(event);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t},\n\t\t\tend() {\n\t\t\t\tsubscriptions.forEach(x => x.unsubscribe());\n\t\t\t\ttouchStart.unsubscribe();\n\t\t\t\ttouchMove.unsubscribe();\n\t\t\t\ttouchEnd.unsubscribe();\n\t\t\t\ttouchPress.unsubscribe();\n\t\t\t\tlongTouch.unsubscribe();\n\t\t\t}\n\t\t};\n\t};\n};\n"]},"metadata":{},"sourceType":"module"}